## 📌 동기화란?


다수의 프로세스, 혹은 쓰레드에서 같은 공유 자원에 동시에 접근해야 하는 경우가 생긴다.

해당 경우에, 프로세스들이 같은 공유자원에 접근할 때 일관된 순서가 정해지지 않으면 데이터의 일관성이 깨지게 된다.

그래서 **프로세스가 동시에 같은 공유자원에 접근할 때 접근 순서를 보장해주는 과정**이 `동기화`이다.

<br>

---
## 📌 Race Condition

> 여러 프로세스가 동시에 공유 데이터에 접근하고 데이터를 수정하고 있는 상황을 말한다.

Race Condition이 발생하면 공유 데이터의 최종 값은 마지막으로 공유 데이터에 쓰여지는 값이 된다.

Race Condition을 방지하려면 프로세스를 동기화해 한번에 하나의 프로세스만 공유 데이터에 접근하도록 해야한다.

<br>

---

## 📌 임계 영역 (Critical Section)
> Race Condition에 놓인 프로세스들의 Code 영역, 즉 공유자원이 여러 프로세스들에 의해 동시 다발적으로 접근될 수 있는 영역이다. 

### 🤔 Critical Section Problem의 해결법
공유 자원의 접근 순서를 제어하기 위해서 만족해야할 3가지의 조건은 다음과 같다.

**Mutual Exclusion (상호배제)**
하나의 프로세스, 혹은 쓰레드가 임계영역에서 실행 중이면 다른 프로세스, 혹은 쓰레드가 접근하면 안된다.

**Progress (deadlock 회피) (진행)**
어떠한 경우에도 각 프로세스, 쓰레드가 자신이 실행해야할 작업을 만들어야 한다.

**Bounded Waiting (starvation 회피) (한정 대기)**
프로세스, 쓰레드가 임계영역에 진입할 때, 기다리는 시간의 제한이 있어야한다. ( 무한정 X )
그리고 임계영역 부분은 최대한 줄이는 것이 성능에 중요한 영향을 미친다.

<br>

---

## 📌 동기화 기법의 종류

### 🔍 세마포어
세마포어란 정수 값을 가지며 두 가지 연산인 P와 V 연산으로 구성된 다중 프로그래밍 환경에서 공유 자원에 대한 접근을 제어하기 위한 동기화 도구 중 하나이다.

세마포어 변수를 통해 공유자원에 접근할 수 있는 프로세스(스레드)의 수를 제어하고 프로세스의 실행 순서를 원하는 순서로 제어할 수 있다.

**이진 세마포어**
0과 1의 값만 가능해서,  'Mutex락'과 유사하게 동작하는 세마포어 

**카운팅 세마포어**
영역(domain)에 제한이 없어 총 가용한 자원의 개수로 초기화되는 세마포어

카운팅 세마포어는 세마포어의 한 종류로, 특정 자원의 사용 가능한 개수를 나타내는 변수.

이 변수는 초기값을 가지며, 자원을 사용할 때마다 값을 감소시키고, 자원을 반납할 때마다 값을 증가시킨다.

값이 0인 경우에는 자원을 사용할 수 없고, 값이 양수인 경우에는 자원을 사용할 수 있는 개수를 나타낸다.

카운팅 세마포어는 여러 개의 프로세스나 스레드가 동시에 자원을 사용할 수 있는 경우에 유용하게 사용됩니다.

### 🔍 뮤텍스
뮤텍스는 세마포어와 같이 OS에서 제공하는 동기화 기법 중 하나이다. Binary Semaphore와 같이 1과, 0의 값을 가진다.

세마포어와 비슷하게, 임계영역에 들어갈 때는 Lock을 걸어서 다른 프로세스, 쓰레드가 접근하지 못하도록 하고 임계영역에서 나올 때 Unlock한다.

### 🔍 모니터
내부의 프로시저를 통해 하나의 스레드만 공유 자원에 접근이 가능하도록 하고 조건 변수를 사용하여 스레드를 대기 시키고 깨울 수 있다.


**뮤텍스와 세마포어의 차이점**

|  | 세마포어 | 뮤텍스 |
| :---- | ------ | :----------: | 
| 공유자원에 접근갯수 | 세마포어 변수만큼 | 1개만의 프로세스/쓰레드 |
| 해제할 수 있는 자원 | 다른 자원이 세마포어 해제 가능 | 락을 걸은 프로세스만 해제 가능 |

=> 뮤텍스는 공유자원을 접근할 수 있는 키가 하나인 세마포어랑 같다. 키가 하냐 쓸수 있냐 여러개 쓸수 있냐의 차이다.


**뮤텍스와 모니터의 차이점**
- 뮤텍스는 다른 프로세스 간에 동기화를 할 때 사용한다. 보통 운영체제 커널에 의해 제공되며 무겁고 느리다.

- 모니터는 하나의 프로세스 내 다른 스레드 간 동기화를 할 때 사용한다. 프레임워크나 라이브러리 그 자체에서 제공되며 가볍고 빠르다.

**세마포어와 모니터의 차이점**

|  | 세마포어 | 뮤텍스 |
| ---- | ------ | ---------- | 
| 특징 | 낮은 수준의 동기화 기본 요소로, 정수 값을 가진 변수와 두 가지 원자적 연산 (wait, signal)으로 구성 | 높은 수준의 동기화 추상화로, 객체 지향 프로그래밍 개념을 사용하여 공유 자원에 대한 접근을 제어 |
|구현 및 사용 방법|커널이 제공하는 기능을 사용하여 구현 / wait, signal 연산을 사용하여 동기화 수행|프로그래밍 언어 레벨에서 제공되는 추상 데이터 타입으로, 공유 자원에 대한 접근을 제한하는 메소드와 조건 변수를 사용하여 동기화를 수행|
|단점|	세마포어는 프로그래머가 직접 동기화를 제어해야 하므로, 오류 발생 가능성이 높음||	 
|장점	| 	|모니터는 상호 배제와 조건 변수를 사용해 동기화를 자동으로 처리하므로, 프로그래머의 실수 가능성이 낮아짐|

=> 모니터가 세마포어에 비해서 공유자원에 접근할 수 있는 키의 획득과 해제를 모두 처리해서 간단하다. 세마포어는 직접 키 해제와 공유자원 접근 처리를 해주어야한다.

 


